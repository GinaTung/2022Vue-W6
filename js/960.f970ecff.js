"use strict";(self["webpackChunknew_project_w6"]=self["webpackChunknew_project_w6"]||[]).push([[960],{530:function(t,e,s){function a(t){return{all:t=t||new Map,on:function(e,s){var a=t.get(e);a?a.push(s):t.set(e,[s])},off:function(e,s){var a=t.get(e);a&&(s?a.splice(a.indexOf(s)>>>0,1):t.set(e,[]))},emit:function(e,s){var a=t.get(e);a&&a.slice().map((function(t){t(s)})),(a=t.get("*"))&&a.slice().map((function(t){t(e,s)}))}}}s.d(e,{Z:function(){return n}});const l=a();var n=l},960:function(t,e,s){s.r(e),s.d(e,{default:function(){return R}});var a=s(252),l=s(577),n=s(963);const i={class:"container"},o={class:"table align-middle"},c=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"圖片"),(0,a._)("th",null,"商品名稱"),(0,a._)("th",null,"價格"),(0,a._)("th")])],-1),d={style:{width:"200px"}},u={key:0,class:"h5"},r={key:1},p={class:"h6"},g={class:"h5"},h={class:"btn-group btn-group-sm"},_=["onClick","disabled"],b=["onClick","disabled"],m={class:"spinner-border spinner-border-sm"},v=(0,a.Uk)(" 加到購物車 "),w={class:"text-end"},y=(0,a._)("div",null,null,-1),k={class:"table align-middle"},x=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th"),(0,a._)("th",null,"品名"),(0,a._)("th",{style:{width:"150px"}},"數量/單位"),(0,a._)("th",null,"單價")])],-1),C=["onClick"],f={key:0,class:"text-success"},D={key:1,class:"text-danger"},I={class:"input-group input-group-sm"},z={class:"input-group mb-3"},$=["onUpdate:modelValue","onChange","disabled"],L=["value"],U={class:"input-group-text",id:"basic-addon2"},q={class:"text-end"},j={class:"text-start"},A={key:0},H=(0,a._)("small",{class:"text-success"},"折扣價：",-1),K=(0,a.Uk)(" 50 "),M=[H,K],P={key:1},Y=(0,a._)("small",{class:"text-success"},null,-1),Z=[Y],T=(0,a._)("td",{colspan:"3",class:"text-end"},"總計",-1),V={class:"text-end"},F=(0,a._)("tr",null,[(0,a._)("td",{colspan:"3",class:"text-end text-success"},"折扣價"),(0,a._)("td",{class:"text-end text-success"},"0")],-1),O=(0,a._)("td",{colspan:"3",class:"text-end text-success"},"結帳金額",-1),B={class:"text-end text-success"};function E(t,e,s,H,K,Y){return(0,a.wg)(),(0,a.iD)("div",i,[(0,a._)("table",o,[c,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(K.products,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",d,[(0,a._)("div",{style:(0,l.j5)([{backgroundImage:`url(${e.imageUrl})`},{height:"100px","background-size":"cover","background-position":"center"}])},null,4)]),(0,a._)("td",null,(0,l.zw)(e.title),1),(0,a._)("td",null,[e.price===e.origin_price?((0,a.wg)(),(0,a.iD)("div",u,(0,l.zw)(e.price)+" 元 ",1)):((0,a.wg)(),(0,a.iD)("div",r,[(0,a._)("del",p,"原價 "+(0,l.zw)(e.origin_price)+" 元",1),(0,a._)("div",g,"現在只要 "+(0,l.zw)(e.price)+" 元",1)]))]),(0,a._)("td",null,[(0,a._)("div",h,[(0,a._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:s=>t.openProductModal(e.id),disabled:K.isLoadingItem===e.id}," 查看更多 ",8,_),(0,a._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t=>Y.addToCart(e.id),disabled:K.isLoadingItem===e.id},[(0,a.wy)((0,a._)("span",m,null,512),[[n.F8,K.isLoadingItem===e.id]]),v],8,b)])])])))),128))])]),(0,a._)("div",w,[(0,a._)("button",{class:"btn btn-outline-danger",type:"button",onClick:e[0]||(e[0]=(...t)=>Y.deleteAllCarts&&Y.deleteAllCarts(...t))}," 清空購物車 ")]),y,(0,a._)("table",k,[x,(0,a._)("tbody",null,[K.cartData.carts?((0,a.wg)(!0),(0,a.iD)(a.HY,{key:0},(0,a.Ko)(K.cartData.carts,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",null,[(0,a._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>Y.removeCartItem(e.id)}," x ",8,C)]),(0,a._)("td",null,[(0,a.Uk)((0,l.zw)(e.product.title)+" ",1),e.total>2e3?((0,a.wg)(),(0,a.iD)("div",f," 已套用優惠券 ")):((0,a.wg)(),(0,a.iD)("div",D,"未套用優惠券"))]),(0,a._)("td",null,[(0,a._)("div",I,[(0,a._)("div",z,[(0,a.wy)((0,a._)("select",{id:"",class:"form-select","onUpdate:modelValue":t=>e.qty=t,onChange:s=>t.updateCartItem(e),disabled:K.isLoadingItem===e.id},[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(20,(t=>(0,a._)("option",{value:t,key:`${t}-${e.id}`},(0,l.zw)(t),9,L))),64))],40,$),[[n.bM,e.qty]]),(0,a._)("span",U,(0,l.zw)(e.product.unit),1)])])]),(0,a._)("td",q,[(0,a._)("div",j,(0,l.zw)(e.product.price),1),e.total>2e3?((0,a.wg)(),(0,a.iD)("span",A,M)):((0,a.wg)(),(0,a.iD)("span",P,Z))])])))),128)):(0,a.kq)("",!0)]),(0,a._)("tfoot",null,[(0,a._)("tr",null,[T,(0,a._)("td",V,(0,l.zw)(K.cartData.total),1)]),F,(0,a._)("tr",null,[O,(0,a._)("td",B,"$ "+(0,l.zw)(K.cartData.final_total),1)])])])])}var G=s(530),J={data(){return{cartData:{},products:[],isLoadingItem:""}},methods:{getProducts(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/yuling202202/products/all").then((t=>{this.products=t.data.products,console.log(t)})).catch((t=>{alert(t.data.message)}))},deleteAllCarts(){this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/yuling202202/carts").then((t=>{alert(t.data.message),this.getCart()})).catch((t=>{alert(t.data.message)}))},getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/yuling202202/cart").then((t=>{console.log(t),this.cartData=t.data.data})).catch((t=>{alert(t.data.message)}))},addToCart(t,e=1){const s={product_id:t,qty:e};this.isLoadingItem=t,this.$http.post("https://vue3-course-api.hexschool.io/v2/api/yuling202202/cart",{data:s}).then((t=>{console.log(t),this.isLoadingItem="",G.Z.emit("get-cart")})).catch((t=>{alert(t.data)}))},removeCartItem(t){this.isLoadingItem=t,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/yuling202202/cart/${t}`).then((t=>{console.log(t),this.getCart(),this.isLoadingItem=""})).catch((t=>{alert(t.data.message)}))}},mounted(){this.getProducts(),this.getCart()}},N=s(744);const Q=(0,N.Z)(J,[["render",E]]);var R=Q}}]);
//# sourceMappingURL=960.f970ecff.js.map